<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<title>Hua Trung</title>
<meta name="description" content="">
<meta name="viewport" content="width=device-width, initial-scale=1">

<!-- favicon
============================================		
<link rel="shortcut icon" type="image/x-icon" href="/assets/img/favicon.ico">
 -->
<!-- Google Fonts
============================================ -->
<link href='https://fonts.googleapis.com/css?family=Open+Sans:300,400,600,700' rel='stylesheet' type='text/css'>

<!-- Bootstrap CSS
============================================ -->
<link rel="stylesheet" href="/assets/css/bootstrap.min.css">
<!-- font-awesome CSS
============================================ -->
<link rel="stylesheet" href="/assets/css/font-awesome.min.css">
<!-- owl.carousel CSS
============================================ -->
<link rel="stylesheet" href="/assets/css/owl.carousel.css">
<link rel="stylesheet" href="/assets/css/owl.theme.css">
<link rel="stylesheet" href="/assets/css/owl.transitions.css">
<!-- meanmenu CSS
============================================ -->
<link rel="stylesheet" href="/assets/css/meanmenu.css">
<!-- normalize CSS
============================================ -->
<link rel="stylesheet" href="/assets/css/normalize.css">
<!-- main CSS
============================================ -->
<link rel="stylesheet" href="/assets/css/main.css">
<!-- style CSS
============================================ -->
<link rel="stylesheet" href="/assets/style.css">
<!-- responsive CSS
============================================ -->
<link rel="stylesheet" href="/assets/css/responsive.css">

<!-- <link rel="stylesheet" href="/assets/css/fallenscence.css"> -->

<!-- modernizr JS
============================================ -->
<script src="/assets/js/vendor/modernizr-2.8.3.min.js"></script>
<style>
   .preloader {
      margin: 300px auto;
      width: 70px;
      height: 30px;
      text-align: center;
      font-size: 10px;
    }

    .preloader > div {
      background-color: #03a9f4;
      height: 10px;
      width: 10px;
      border-radius: 50%;
      display: inline-block;
      
      -webkit-animation: stretchdelay 0.7s infinite ease-in-out;
      animation: stretchdelay 0.7s infinite ease-in-out;
    }

    .preloader .circ2 {
      -webkit-animation-delay: -0.6s;
      animation-delay: -0.6s;
    }

    .preloader .circ3 {
      -webkit-animation-delay: -0.5s;
      animation-delay: -0.5s;
    }

    .preloader .circ4 {
      -webkit-animation-delay: -0.4s;
      animation-delay: -0.4s;
    }

    .preloader .circ5 {
      -webkit-animation-delay: -0.3s;
      animation-delay: -0.3s;
    }

    @-webkit-keyframes stretchdelay {
      0%, 40%, 100% { -webkit-transform: translateY(-10px) }  
      20% { -webkit-transform: translateY(-20px) }
    }

    @keyframes stretchdelay {
      0%, 40%, 100% { 
        transform: translateY(-10px);
        -webkit-transform: translateY(-10px);
      } 20% {
        transform: translateY(-20px);
        -webkit-transform: translateY(-20px);
      }
    }
</style>
</head>


<body class="home-2">
  <!--[if lt IE 8]>
        <p class="bro  wserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
    <![endif]-->
    <div class="preloader">
        <div class="circ1"></div>
        <div class="circ2"></div>
        <div class="circ3"></div>
        <div class="circ4"></div>
    </div>
  <div class="main_home hidden">
      <!-- header-area start -->
<header id="header" class="header-area">
    <div class="header-bottom">
      <div class="container">
        <div class="row">
          <div class="col-md-3">
            <div class="logo">
              <a href="/"><img src="/assets/img/logo/footer-logo.png" alt="Logo" /></a>
            </div>
          </div>
          <div class="col-md-9">
            <div class="main-menu">
              <nav>
                <ul class="main-nav navbar-right">
                  <li><a href="/">Home</a></li>
                  <li><a href="/categories/work/">Work</a></li>
                  <li><a href="/categories/life/">Life</a></li>
                  <li><a href="/categories/fun/">FUN</a></li>
                  <li><a href="/categories/me/">Me</a></li>
                </ul>
              </nav>
            </div><!-- /.main-menu -->
          </div>
        </div>
      </div>
      <!-- mobile-menu-area start -->
      <div class="mobile-menu-area">
        <div class="container">
          <div class="row">
            <div class="col-md-12">
              <nav id="dropdown">
                <ul class="main-nav navbar-right">
                  <li><a href="/">Home</a></li>
                  <li><a href="/categories/work/">Work</a></li>
                  <li><a href="/categories/life/">Life</a></li>
                  <li><a href="/categories/fun/">fun</a></li>
                  <li><a href="/categories/me/">Me</a></li>
                </ul>
              </nav>
            </div>
          </div>
        </div>
      </div>
      <!-- mobile-menu-area end -->
    </div><!-- /.header-bottom -->
  </header>
  <!-- header-area end -->
    
    
    
    <!-- main-content-area start -->

    <div id="main-content" class="main-content-area">
      <div class="container">
        <div class="row">
          <div class="col-md-8 col-sm-12">
            <!-- latest-reviews-area start -->
            <div id="latest-reviews" class="latest-reviews-area">


              <div id="single-blog" class="single-blog-area">
  <div class="container">
    <div class="row">
      <div class="col-md-8 col-md-offset-2">
        <div class="single-blog-details">
            <h1 class="post-title">Tối ưu hóa cache với LFU và LRU</h1>
            <p class="post-date">Posted on 24 July 2019</p>
            <div class="post-long-desc">
              <p>Tối ưu hóa luôn là vấn đề được quan tâm hàng đầu trong nhiều lĩnh vực. Bởi vì tài nguyên chúng ta đang sử dụng có giới hạn, vậy nên con người luôn tìm cách giảm thiếu chi phí và thời gian tới mức tối thiểu.</p>

<p>Trong lập trình cũng vậy, chúng ta cũng phải đối mặt với vấn đề tối ưu hóa thường xuyên. Thực tế, câu hỏi <b>“Làm sao để tối ưu ?”</b> được đặt ra nhiều hơn khi đi làm so với khi còn ngồi trên ghế nhà trường.</p>

<p>Khi còn ở trường, vấn đề tối ưu đầu tiên tôi gặp phải là <b> tối ưu thuật toán fibonaci</b>. Nếu sử dụng cách đệ quy thông thường thì O(n) sẽ là 2<sup>n</sup>. Để tối ưu bài toán, có thể cân nhắc đến kĩ thuật <b>memorization</b> giảm chi phí cho bài toán xuống còn O(n) = n. Bản chất đằng sau của thuật toán này là lưu lại các giá trị đã tính trước để phục vụ cho sau này.</p>

<p>Khi đi làm, để tối ưu trải nghiệm của người dùng sử dụng website thì tôi sử dụng cache. Đây là một hệ thống quan trọng để cải thiện hiệu năng của ứng dụng thông qua việc cho phép truy cập và trích xuất dữ liệu nhanh hơn. Mặc dù có khá nhiều ứng dụng cho cache và phụ thuộc vào tính chất công việc, nhưng ý tưởng đằng sau đó khá đơn giản.</p>

<blockquote>
  <p style="font-size:16px;text-align:center">Lưu trữ những dữ liệu cần thiết hoặc được sử dụng nhiều trong một "kho chứa" để lần lấy ra tiếp theo sẽ nhanh hơn.</p>
</blockquote>

<p>Trong thực tế, cache không nhanh hơn thanh ghi (register) nhưng nhanh hơn nhiều khi so với bộ nhớ chính ( main memory). Để truy cập dữ liệu từ bộ nhớ chính sẽ tốn nhiều thời gian, vậy nên để giảm quá trình này một vùng nhớ đặc biệt trong CPU sẽ được dành riêng chứa một lượng nhỏ dữ liệu cần thiết. Khi một tiến trình muốn tiếp cận lượng dữ liệu trên, đầu tiên nó sẽ kiểm tra trong cache, nếu tìm thấy thì lấy ra và chế biến, nếu không nó mới đi tiếp tới bộ nhớ chính.</p>

<p>Cache phải tuân thủ theo <b>replacement policy</b> khi dung lượng vượt quá giới hạn:</p>
<ul>
    <li>-  Quyết định được dữ liệu nào cần loại bỏ.</li>
    <li>-  Tối thiếu được số lượng cache misses. </li>
    <li>-  Chi phí thấp. </li>
</ul>

<p>Có rất nhiều thuật toán implement cache, trong đó có 2 thuật toán đơn giản là <b>Least Recently Used</b> và<b> Least Frequently Used</b> được sử dụng rộng rãi. Và cũng là 2 thuật toán tôi muốn giới thiệu trong bài viết này.</p>

<h3><b> Least Recently Used </b></h3>
<p>Thuật toán này lấy thời gian lần cuối sử dụng object để quyết định có loại bỏ hay không?. Cụ thể, nó sẽ xóa object có thời điểm được sử dụng gần nhất cách thời điểm hiện tại xa nhất khỏi bộ nhớ khi bộ chứa đạt tới giới hạn. Một object vừa được truy cập sẽ được đẩy vào cache hoặc ghi đè thời gian sử dụng nếu đã nằm sẵn trong cache.</p>

<blockquote>
  <p style="font-size:16px;text-align:center">Ví dụ: Bạn có một tủ chật kín quần áo và cần bỏ đi vài cái để sắm quần áo mới. Lúc này bạn sẽ loại đi những bộ quần áo mà lần gần nhất bạn mặc cách đây lâu nhất. Để giả định này đúng, do uống trà sữa quá nhiều nên tăng cân, bạn không thể mặc những bộ quần áo cũ mặc dù rất đẹp. Lần cuối mặc nó là lúc chưa tăng cân.</p>
</blockquote>

<h5> <u>Phân tích cấu trúc dữ liệu:</u></h5>

<p><br />
Để implement được LRU, cần có một data structure đảm bảo được:</p>

<table style="border-collapse: collapse;">
  <tr>
    <th style="border: 1px solid black;  text-align: left; padding:5px; width:50%">Yêu cầu</th>
    <th style="border: 1px solid black;  text-align: left; padding:5px;">Data structure</th>
    <th style="border: 1px solid black;  text-align: left; padding:5px;">Chi phí độ phức tạp</th>
  </tr>
  <tr>
    <td style="border: 1px solid black;  text-align: left; padding:5px; width:50%">Tìm kiếm</td>
    <td style="border: 1px solid black;  text-align: left; padding:5px;">HashMap hoặc HashTable.</td>
    <td style="border: 1px solid black;  text-align: left; padding:5px;">O(1)</td>
  </tr>
  <tr>
    <td style="border: 1px solid black;  text-align: left; padding:5px; width:50%">Thêm mới một object</td>
    <td style="border: 1px solid black;  text-align: left; padding:5px;">Static array, linked list, Hashmap ( HashTable ) với tỉ lệ collision thấp. </td>
    <td style="border: 1px solid black;  text-align: left; padding:5px;">O(1)</td>
  </tr>
  <tr>
    <td rowspan="2" style="border: 1px solid black;  text-align: left; padding:5px; width:50%">Xóa object gần nhất sử dụng cách hiện tại xa nhất.</td>
    <td style="border: 1px solid black;  text-align: left; padding:5px;">Double Linked list được sắp xếp theo thời gian gần nhất sử dụng tăng dần.</td>
    <td style="border: 1px solid black;  text-align: left; padding:5px;">O(1)</td>
  </tr>
   <tr>
    <td style="border: 1px solid black;  text-align: left; padding:5px;">Hàng đợi ưu tiên ( Priority queue). Cụ thể là Min-heap với key là thời gian gần nhất truy cập của object. </td>
    <td style="border: 1px solid black;  text-align: left; padding:5px;">O(logn)</td>
  </tr>
  <tr>
    <td rowspan="2" style="border: 1px solid black;  text-align: left; padding:5px; width:50%">Khi một object đã có trong cache được truy cập thì sẽ ghi đè thời điểm hiện tại vào cache. Đồng thời vẫn đảm bảo vị trí các object theo chiều tăng dần thời gian.</td>
    <td style="border: 1px solid black;  text-align: left; padding:5px;">Sử dụng HashMap(HashTable) cho tìm kiếm O(1). Với double linked list thì xóa O(1). Sau đó thêm mới object với thời gian hiện tại là O(1).  </td>
    <td style="border: 1px solid black;  text-align: left; padding:5px;">O(1)</td>
  </tr>
   <tr>
    <td style="border: 1px solid black;  text-align: left; padding:5px;">Min-heap như trên. Để đảm bảo tính đúng của Min_heap thì sử dụng heapify cho ta O(logn). </td>
    <td style="border: 1px solid black;  text-align: left; padding:5px;">O(logn)</td>
  </tr>
</table>
<p><br />
Với bảng phân tích như trên chúng ta dễ dàng chọn được cấu trúc dữ liệu thích hợp và tốt nhất để xây dựng LRU là : <b>HashMap</b> và<b> Double Linked List</b>.</p>

<h5> <u>Implement LRU:</u></h5>
<p><b>LRU node </b>chứa dữ liệu, thời gian sử dụng và 2 con trỏ tới các node khác.</p>
<p><b>Hash Map</b> giữ key và LRU node tương ứng.</p>
<p><b>Double Linked List</b> lưu head là node chứa dữ liệu có thời gian sử dụng cuối cùng xa nhất. Ngược lại, tail sẽ lưu node được sử dụng gần đầy nhất.</p>
<p><br />
 <img src="/assets/img/blog/content/lru-1.png" alt="Complicated process" />
<br /><br /></p>

<h5> <u>Coding LRU:</u></h5>
<p><b>LRU Node</b>
<br />
 <img src="/assets/img/blog/content/lru-code1.png" alt="Complicated process" />
<br /><br />
<b>Double Linked List</b>
<br />
 <img src="/assets/img/blog/content/lru-code2.png" alt="Complicated process" />
<img src="/assets/img/blog/content/lru-code3.PNG" alt="Complicated process" /></p>

<h5> <u>Đánh giá với implement bằng priority heap:</u></h5>
<p>Sử dụng thư viện <b>cProfile</b> để đánh giá hiệu năng.<br />
Cache chứa được 2048 phần tử, giá trị random từ 1 đến 5000, 100000 hành động put và 1000 hành động get.
<br />
<img src="/assets/img/blog/content/lru-compare.PNG" alt="Complicated process" />
<br /><br />
<u>HashTable + Double Linked List:</u>
<br />
<br />
<img src="/assets/img/blog/content/lru-compare1.PNG" alt="Complicated process" />
<br /><br />
<u>Priority Heap:</u>
<br />
<br />
<img src="/assets/img/blog/content/lru-compare2.PNG" alt="Complicated process" /></p>
<p> Bỏ thời gian thực hiện random một giá trị cho phần test và các hàm khởi tạo khác. Để khách quan, chúng ta không xét thời gian của hàm tìm kiếm vì với heap sẽ có O(n) ( vì giá trị tìm kiếm không phải là giá trị xây dựng heap ), mà chỉ so sánh thời gian thực hiện hàm xóa và duy trì tính đúng của heap.</p>
<table style="border-collapse: collapse;">
  <tr>
    <th style="border: 1px solid black;  text-align: left; padding:5px; width:50%">Action</th>
    <th style="border: 1px solid black;  text-align: left; padding:5px;">Double Linked List + Hash map</th>
    <th style="border: 1px solid black;  text-align: left; padding:5px;">Priority Heap</th>
  </tr>
  <tr>
    <td style="border: 1px solid black;  text-align: left; padding:5px; width:50%">removeNode + Heapify(for Heap)</td>
    <td style="border: 1px solid black;  text-align: left; padding:5px;">0.21</td>
    <td style="border: 1px solid black;  text-align: left; padding:5px;">3.216</td>
  </tr>
  <tr>
    <td style="border: 1px solid black;  text-align: left; padding:5px; width:50%">updateNode + Heapify(for Heap)</td>
    <td style="border: 1px solid black;  text-align: left; padding:5px;">1.24 </td>
    <td style="border: 1px solid black;  text-align: left; padding:5px;">0.639</td>
  </tr>
  <tr>
    <td style="border: 1px solid black;  text-align: left; padding:5px; width:50%">addNode</td>
    <td style="border: 1px solid black;  text-align: left; padding:5px;">0.02</td>
    <td style="border: 1px solid black;  text-align: left; padding:5px;">0.008</td>
  </tr>
   <tr>
    <td style="border: 1px solid black;  text-align: left; padding:5px; width:50%">Heapify</td>
    <td style="border: 1px solid black;  text-align: left; padding:5px;">0</td>
    <td style="border: 1px solid black;  text-align: left; padding:5px;">3.670</td>
  </tr>
</table>
<p><br />
Heapify có độc phức tạp là O(logn). Vậy nên khi so sánh update và remove với HashMap + Double Linked List có O(1) thì thời gian chênh nhau khá lớn. Chỉ tính riêng Heapify đã chiếm thời gian nhiều nhất. Ở bài tiếp theo tôi sẽ giới thiệu <b> Least Frequently Used</b>.</p>

            </div>
            <div class="single-blog-bottom fix">
              <!-- <div class="post-social-links pull-left">
                <p>
                  <span class="lbl">Share on&nbsp;&nbsp;-</span>
                  <span>
                    <a href="#"><i class="fa fa-facebook"></i></a>
                    <a href="#"><i class="fa fa-twitter"></i></a>
                    <a href="#"><i class="fa fa-google-plus"></i></a>
                    <a href="#"><i class="fa fa-pinterest"></i></a>
                  </span>
                </p>
              </div>
              <div class="post-tags pull-right">
                <p>
                  <span class="lbl">Tags&nbsp;&nbsp;-</span>
                  <span>
                     <a href="#">sports,</a>
                    <a href="#">football,</a>
                    <a href="#">soccer</a> 
                  </span>
                </p>
              </div>
            </div> -->
            <div class="about-author fix">
              <h6 class="title">about the author</h6>
              <div class="author-img">
                <img src="http://0.0.0.0:4000/assets/img/comments/author.png" alt="Author Image" width="100px" height="100px" />
              </div>
              <div class="author-info">
                <p> If you can't explain it simply, you don't understand it enough.
                   If you can't explain it to a six year old, you don't understand it yourself.</p>
              </div>
            </div><!-- /.about-author -->
            <div id="disqus_thread"></div>
            <script>
            
            /**
            *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
            *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
            /*
            var disqus_config = function () {
            this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
            this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
            };
            */
            (function() { // DON'T EDIT BELOW THIS LINE
            var d = document, s = d.createElement('script');
            s.src = 'https://huatrungblog.disqus.com/embed.js';
            s.setAttribute('data-timestamp', +new Date());
            (d.head || d.body).appendChild(s);
            })();
            </script>
            <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
                                 
            
            
          </div><!-- /.single-blog-details -->
        </div>
      </div>
    </div>
  </div>


              <div class="row">
                <div class="col-md-12 text-center">
                  <div class="pagination p1">
                    
                  </div>
                </div>
              </div>
            </div>

            <!-- latest-reviews-area end -->
          </div>
          
        </div>
      </div>
    </div>
    <!-- main-content-area end -->

    <!-- footer-area start -->
    <footer id="footer" class="footer-area text-center">
    <div class="footer-logo">
      <!-- <a href="#"><img src="/assets/img/logo/footer-logo.png" alt="Footer Logo" /></a> -->
    </div>
    <p class="copyright-text">&copy; Copyright© 2019 Blogging. All right reserved.</p>
  </footer>
    <!-- footer-area end -->
  </div>
  <!-- footer javascript -->
    <!-- jquery
============================================ -->
<script src="/assets/js/vendor/jquery-1.11.3.min.js"></script>
<!-- bootstrap JS
============================================ -->
<script src="/assets/js/bootstrap.min.js"></script>
<!-- meanmenu JS
============================================ -->
<script src="/assets/js/jquery.meanmenu.js"></script>
<!-- owl.carousel JS
============================================ -->
<script src="/assets/js/owl.carousel.min.js"></script>
<!-- scrollUp JS
============================================ -->
<script src="/assets/js/jquery.scrollUp.min.js"></script>
<!-- plugins JS
============================================ -->
<script src="/assets/js/plugins.js"></script>
<!-- main JS
============================================ -->
<script src="/assets/js/main.js"></script>
<script>
  window.addEventListener("load",function(event){

    $(".preloader").addClass( "hidden" );
    $(".main_home").removeClass( "hidden" );
    event.preventDefault();

  //   var owl = $('.owl-wrapper');
  //   owl.trigger('play.owl.autoplay',[1])

  //   var LeafScene = function(el) {
  //   this.viewport = el;
  //   this.world = document.createElement('div');
  //   this.leaves = [];

  //   this.options = {
  //     numLeaves: 20,
  //     wind: {
  //       magnitude: 1.2,
  //       maxSpeed: 12,
  //       duration: 300,
  //       start: 0,
  //       speed: 0
  //     },
  //   };

  //   this.width = this.viewport.offsetWidth;
  //   this.height = this.viewport.offsetHeight;

  //   // animation helper
  //   this.timer = 0;

  //   this._resetLeaf = function(leaf) {

  //     // place leaf towards the top left
  //     leaf.x = this.width * 2 - Math.random()*this.width*1.75;
  //     leaf.y = -10;
  //     leaf.z = Math.random()*200;
  //     if (leaf.x > this.width) {
  //       leaf.x = this.width + 10;
  //       leaf.y = Math.random()*this.height/2;
  //     }
  //     // at the start, the leaf can be anywhere
  //     if (this.timer == 0) {
  //       leaf.y = Math.random()*this.height;
  //     }

  //     // Choose axis of rotation.
  //     // If axis is not X, chose a random static x-rotation for greater variability
  //     leaf.rotation.speed = Math.random()*10;
  //     var randomAxis = Math.random();
  //     if (randomAxis > 0.5) {
  //       leaf.rotation.axis = 'X';
  //     } else if (randomAxis > 0.25) {
  //       leaf.rotation.axis = 'Y';
  //       leaf.rotation.x = Math.random()*180 + 90;
  //     } else {
  //       leaf.rotation.axis = 'Z';
  //       leaf.rotation.x = Math.random()*360 - 180;
  //       // looks weird if the rotation is too fast around this axis
  //       leaf.rotation.speed = Math.random()*3;
  //     }

  //     // random speed
  //     leaf.xSpeedVariation = Math.random() * 0.8 - 0.4;
  //     leaf.ySpeed = Math.random() + 1.5;

  //     return leaf;
  //   }

  //   this._updateLeaf = function(leaf) {
  //     var leafWindSpeed = this.options.wind.speed(this.timer - this.options.wind.start, leaf.y);

  //     var xSpeed = leafWindSpeed + leaf.xSpeedVariation;
  //     leaf.x -= xSpeed;
  //     leaf.y += leaf.ySpeed;
  //     leaf.rotation.value += leaf.rotation.speed;

  //     var t = 'translateX( ' + leaf.x + 'px ) translateY( ' + leaf.y + 'px ) translateZ( ' + leaf.z + 'px )  rotate' + leaf.rotation.axis + '( ' + leaf.rotation.value + 'deg )';
  //     if (leaf.rotation.axis !== 'X') {
  //       t += ' rotateX(' + leaf.rotation.x + 'deg)';
  //     }
  //     leaf.el.style.webkitTransform = t;
  //     leaf.el.style.MozTransform = t;
  //     leaf.el.style.oTransform = t;
  //     leaf.el.style.transform = t;

  //     // reset if out of view
  //     if (leaf.x < -10 || leaf.y > this.height + 10) {
  //       this._resetLeaf(leaf);
  //     }
  //   }

  //   this._updateWind = function() {
  //     // wind follows a sine curve: asin(b*time + c) + a
  //     // where a = wind magnitude as a function of leaf position, b = wind.duration, c = offset
  //     // wind duration should be related to wind magnitude, e.g. higher windspeed means longer gust duration

  //     if (this.timer === 0 || this.timer > (this.options.wind.start + this.options.wind.duration)) {

  //       this.options.wind.magnitude = Math.random() * this.options.wind.maxSpeed;
  //       this.options.wind.duration = this.options.wind.magnitude * 50 + (Math.random() * 20 - 10);
  //       this.options.wind.start = this.timer;

  //       var screenHeight = this.height;

  //       this.options.wind.speed = function(t, y) {
  //         // should go from full wind speed at the top, to 1/2 speed at the bottom, using leaf Y
  //         var a = this.magnitude/2 * (screenHeight - 2*y/3)/screenHeight;
  //         return a * Math.sin(2*Math.PI/this.duration * t + (3 * Math.PI/2)) + a;
  //       }
  //     }
  //   }
  // }

  // LeafScene.prototype.init = function() {

  //   for (var i = 0; i < this.options.numLeaves; i++) {
  //     var leaf = {
  //       el: document.createElement('div'),
  //       x: 0,
  //       y: 0,
  //       z: 0,
  //       rotation: {
  //         axis: 'X',
  //         value: 0,
  //         speed: 0,
  //         x: 0
  //       },
  //       xSpeedVariation: 0,
  //       ySpeed: 0,
  //       path: {
  //         type: 1,
  //         start: 0,

  //       },
  //       image: 1
  //     };
  //     this._resetLeaf(leaf);
  //     this.leaves.push(leaf);
  //     this.world.appendChild(leaf.el);
  //   }

  //   this.world.className = 'leaf-scene';
  //   this.viewport.appendChild(this.world);

  //   // set perspective
  //   this.world.style.webkitPerspective = "400px";
  //   this.world.style.MozPerspective = "400px";
  //   this.world.style.oPerspective = "400px";
  //   this.world.style.perspective = "400px";
    
  //   // reset window height/width on resize
  //   var self = this;
  //   window.onresize = function(event) {
  //     self.width = self.viewport.offsetWidth;
  //     self.height = self.viewport.offsetHeight;
  //   };
  // }

  // LeafScene.prototype.render = function() {
  //   this._updateWind();
  //   for (var i = 0; i < this.leaves.length; i++) {
  //     this._updateLeaf(this.leaves[i]);
  //   }

  //   this.timer++;

  //   requestAnimationFrame(this.render.bind(this));
  // }

  // // start up leaf scene
  // var leafContainer = document.querySelector('.falling-leaves'),
  //     leaves = new LeafScene(leafContainer);

  // leaves.init();
  // leaves.render();
  })

</script>



  
  <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-92878342-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-92878342-1');
</script>

</body>

</html>